var stylus=require("stylus"),Canvas=require("canvas"),nodes=stylus.nodes,utils=stylus.utils;exports=module.exports=Gradient;exports.create=function(t,i){utils.assertType(t,"unit","size");utils.assertString(i,"start");return new Gradient(t.val,i.string)};exports.addColorStop=function(t,i,s){utils.assertType(t,"gradient","grad");utils.assertType(i,"unit","pos");utils.assertColor(s,"color");t.addColorStop(i.val/100,s.rgba.toString());return nodes.null};exports.dataURL=function(t){utils.assertType(t,"gradient");return new nodes.String(t.toDataURL())};function Gradient(t,i){this.size=t;this.canvas=new Canvas(1,1);this.setStartPosition(i);this.ctx=this.canvas.getContext("2d");this.grad=this.ctx.createLinearGradient(this.from[0],this.from[1],this.to[0],this.to[1])}Gradient.prototype.toString=function(){return"Gradient("+this.size+"px "+this.stops.map(function(t){return t[0]+" "+t[1]}).join(", ")+")"};Gradient.prototype.setStartPosition=function(t){var i=this.size,s=this.canvas;switch(t){case"top":s.height=i;this.from=[s.width/2,0];this.to=[s.width/2,s.height];break;case"bottom":s.height=i;this.from=[s.width/2,s.height];this.to=[s.width/2,0];break;case"left":s.width=i;this.from=[0,0];this.to=[s.width,s.height];break;case"right":s.width=i;this.from=[s.width,s.height];this.to=[0,0];break;default:throw new Error('invalid start position "'+t+'"')}};Gradient.prototype.addColorStop=function(t,i){this.grad.addColorStop(t,i)};Gradient.prototype.toDataURL=function(){var t=this.canvas,i=this.ctx;i.fillStyle=this.grad;i.fillRect(0,0,t.width,t.height);return t.toDataURL()};Gradient.prototype.__proto__=nodes.Node.prototype;